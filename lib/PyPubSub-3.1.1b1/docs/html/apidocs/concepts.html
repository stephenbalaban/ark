<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Concepts &mdash; Python PubSub Website</title>
    <link rel="stylesheet" href="../_static/split_tocs.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <!--[if lte IE 8]><link rel="stylesheet" href="../_static/ie_split_tocs.css" type="text/css" /><![endif]-->
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '3.1.0b1',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="top" title="Python PubSub Website" href="../index.html" />
    <link rel="up" title="API Documentation" href="index.html" />
    <link rel="next" title="Basic Use" href="basic_use.html" />
    <link rel="prev" title="Examples" href="examples.html" /> 
  </head>
  <body>
  <div class="docsheader">
    <h3>Python PubSub Website</h3>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../modindex.html" title="Global Module Index"
             accesskey="M">modules</a> |</li>
        <li class="right" >
          <a href="basic_use.html" title="Basic Use"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="examples.html" title="Examples"
             accesskey="P">previous</a> |</li>
        <li>Trail:</li>
          <li> &raquo; <a href="index.html" accesskey="U">API Documentation</a></li>
          <li> &raquo; <a href="#">Concepts</a></li> 
      </ul>
    </div>
  </div>
 
      <div class="splitsidebar">
        <div class="mainsidebarpanel">
            <h3><a href="../index.html">Site Contents</a></h3>
            <ul class="current">
<li class="toctree-l1"><a class="reference" href="../index.html">Home Page</a></li>
<li class="toctree-l1"><a class="reference" href="../about.html">About</a><ul>
<li class="toctree-l2"><a class="reference" href="../projectsusing.html">Pubsub Users</a></li>
<li class="toctree-l2"><a class="reference" href="../history.html">History</a></li>
<li class="toctree-l2"><a class="reference" href="../development.html">Development</a><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference" href="../installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference" href="../download.html">Download</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference" href="../changelog.html">Changelog</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference" href="index.html">API Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference" href="examples.html">Examples</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference" href="">Concepts</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference" href="basic_use.html">Basic Use</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference" href="more_advanced_use.html">Advanced Use</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference" href="docs4v1.html">Legacy (v1) API</a><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference" href="../recipes/index.html">Pubsub Recipes</a><ul>
<li class="toctree-l2"><a class="reference" href="../recipes/upgrade_v1tov3.html">Upgrade from v1</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference" href="../recipes/arg1_to_kwargs.html">Convert Arg1 to Kwargs</a><ul class="simple">
</ul>
</li>
</ul>
</li>
</ul>

          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../search.html" method="get">
                <input type="text" name="q" size="18" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div> 

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="concepts">
<h1>Concepts<a class="headerlink" href="#concepts" title="Permalink to this headline">¶</a></h1>
<p>Pubsub facilitates the <em>decoupling</em> of components (callables, modules, packages) within
an application. It does this by:</p>
<ul class="simple">
<li>Allowing parts of the application to send messages to &#8220;the rest of the
application&#8221; without having to know<ul>
<li><em>if</em> the messages will be handled:<ul>
<li>perhaps the message will be ignored completely,</li>
<li>or handled by a many different parts of the application;</li>
</ul>
</li>
<li><em>how</em> the messages will be handled:<ul>
<li>what will be done with the message and its contents;</li>
<li>in what order any given message will be sent to the
rest of the application;</li>
</ul>
</li>
</ul>
</li>
<li>Allowing parts of the application to receive and handle messages from
&#8220;the rest of the application&#8221; without having to know <em>who</em> sent
the messages.</li>
</ul>
<p>A <em>listener</em> is &#8220;a part of the application that wants to receive messages&#8221;.
A listener subscribes to one or more topics. A <em>sender</em> is any part of the
application that asks Pubsub to send a message of a given topic. The sender
provides data, if any. Pubsub will send the message, including any data,
to all listeners of the message&#8217;s topic.</p>
<div align="center" class="align-center"><img alt="Should be image: Sketch showing how pubsub fits into an application" class="align-center" src="../_images/pubsub_concept.png" style="width: 450px;" /></div>
<p>More details follow.</p>
<div class="section" id="messages">
<h2>Messages<a class="headerlink" href="#messages" title="Permalink to this headline">¶</a></h2>
<p>A message</p>
<ul class="simple">
<li>Can be considered as a signal that something happened (an event);</li>
<li>Can transport data;</li>
<li>Has a <em>type</em>, referred to as the <em>topic</em> of the message.
The topic, similarly to classes in Python, sets certain constraints on the
message: what data is required to be sent as part of the message, and what
additional data <em>can</em> be sent.</li>
</ul>
</div>
<div class="section" id="topics">
<h2>Topics<a class="headerlink" href="#topics" title="Permalink to this headline">¶</a></h2>
<p>As mentioned above, any message sent has a <em>type</em>, referred to as the <em>topic</em>
of the message. Topic names are strings: &#8220;sports&#8221;, &#8220;user&#8221;, &#8220;cards&#8221;,
&#8220;app_options&#8221;, etc.</p>
<p>Topics form a hierarchy:</p>
<ul class="simple">
<li>The complete topic name uses <em>dotted notation</em>: &#8220;sports.baseball&#8221;,
&#8220;sports.hockey&#8221;, &#8220;user.saveFile&#8221;, &#8220;user.openFile&#8221;, etc.</li>
<li>The root of the topic hierarchy is the <em>ALL_TOPICS</em> topic. Listeners of
the root topic receive all messages sent in the application.</li>
<li>Messages of topic &#8220;a.b.c&#8221; will be received by listeners of &#8220;a.b.c&#8221;,
listeners of &#8220;a.b&#8221;, listeners of &#8220;a&#8221;, and listeners of ALL_TOPICS.</li>
</ul>
<p>The topic hierarchy can be created on the fly by the application (default),
or can be specified and documented via one or more <em>Topic Definition Providers</em>
(TDP). TDP&#8217;s are objects that state</p>
<ul class="simple">
<li>what are valid topic names in the application</li>
<li>what is the topic hierarchy</li>
<li>what data is allowed or required when sending messages for each topic</li>
<li>describe what is the purpose of each topic and message data</li>
</ul>
<p>Pubsub can be setup to deny (via an exception) any attempt to use a topic
that is not specified by a TDP. This is very useful in larger applications.</p>
<p>Every topic has a message arguments specification, i.e. a prescribed
set of argument names that are allowed when sending a message of that
topic. This is the <em>TMAS</em>, for <em>topic message arguments specification</em>.
For instance, topic &#8220;sports.baseball&#8221; might have following TMAS:</p>
<ul class="simple">
<li>playersA: list of players in team A</li>
<li>playersB: list of players in team B</li>
<li>location: where the game is taking place</li>
<li>dateTime: when is the game</li>
</ul>
<p>but only location and playersA are required: playersB and dateTime are
only used during a match (vs a practice). Then every message of topic
&#8220;sports.baseball&#8221; must be given at least a location and list for playersA,
and every recipient of the message must accept all four parameters (since
some messages will have all four parameters). I.e.:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">pub</span><span class="o">.</span><span class="n">sendMessage</span><span class="p">(</span><span class="s">&quot;sports.baseball&quot;</span><span class="p">,</span> <span class="n">playersA</span><span class="o">=</span><span class="p">[],</span> <span class="n">location</span><span class="o">=</span><span class="s">&quot;Montreal&quot;</span><span class="p">)</span>
<span class="n">pub</span><span class="o">.</span><span class="n">sendMessage</span><span class="p">(</span><span class="s">&quot;sports.baseball&quot;</span><span class="p">,</span> <span class="n">playersA</span><span class="o">=</span><span class="p">[],</span> <span class="n">playersB</span><span class="o">=</span><span class="p">[],</span> <span class="n">location</span><span class="o">=</span><span class="s">&quot;Montreal&quot;</span><span class="p">)</span>
<span class="n">pub</span><span class="o">.</span><span class="n">sendMessage</span><span class="p">(</span><span class="s">&quot;sports.baseball&quot;</span><span class="p">,</span> <span class="n">playersA</span><span class="o">=</span><span class="p">[],</span> <span class="n">location</span><span class="o">=</span><span class="s">&quot;Montreal&quot;</span><span class="p">,</span> <span class="n">dateTime</span><span class="o">=</span><span class="n">today</span><span class="p">()</span> <span class="p">)</span>
<span class="n">pub</span><span class="o">.</span><span class="n">sendMessage</span><span class="p">(</span><span class="s">&quot;sports.baseball&quot;</span><span class="p">,</span> <span class="n">playersA</span><span class="o">=</span><span class="p">[],</span> <span class="n">playersB</span><span class="o">=</span><span class="p">[],</span> <span class="n">location</span><span class="o">=</span><span class="s">&quot;Montreal&quot;</span><span class="p">,</span> <span class="n">dateTime</span><span class="o">=</span><span class="n">today</span><span class="p">()</span> <span class="p">)</span>

<span class="n">pub</span><span class="o">.</span><span class="n">sendMessage</span><span class="p">(</span><span class="s">&quot;sports.baseball&quot;</span><span class="p">,</span> <span class="n">playersA</span><span class="o">=</span><span class="p">[])</span> <span class="c"># ERROR: required location missing</span>
</pre></div>
</div>
<p>The TMAS of each topic:</p>
<ul class="simple">
<li>Is obtained from the first TDP that provides it. If the application
does not use TDP&#8217;s, the TMAS is inferred from the first listener
subscribed to the topic.</li>
<li>Extends the TMAS of the parent topic. This is almost identical to
inheritence of attributes in a class hierarchy. For instance if topic
&#8220;a.b&#8221; has TMAS (arg1 (required), arg2 (optional)), then topic &#8220;a.b.c&#8221;
has at least that TMAS, and topic &#8220;a&#8221; has at most that TMAS.</li>
</ul>
</div>
<div class="section" id="listeners">
<h2>Listeners<a class="headerlink" href="#listeners" title="Permalink to this headline">¶</a></h2>
<p>A listener is a Python callable object (i.e. a function, method or
instance with a __call__ method). A listener subscribes to topics that
it wants to listen to. The only restrictions on listeners are:</p>
<ul class="simple">
<li>A listener must satisfy the TMAS of a topic
otherwise it will be rejected when requesting to subscribe, leading
to a ListenerInadequate exception.</li>
<li>A listener <strong>must not</strong> raise any exceptions since neither pubsub
nor the sender of a message know anything about the listener, let
alone what exceptions it can raise and what to do with them. See
<a class="reference" href="more_advanced_use.html#exception-handling"><em>Exception Handling</em></a>.</li>
</ul>
<p>A listener should not make any assumptions about:</p>
<ul class="simple">
<li>The order of calls of listeners subscribed to same or other topics</li>
<li>Where the message originates</li>
</ul>
<p>Listeners that are subscribed are held by pubsub in a registry.
However, Listeners are stored in this registry in such a way that when the
application no longer uses the listener (reference count goes to
zero), it is removed from the registry. In other words, the
listener is stored in the registry by weak reference only. This
prevents pubsub from artificially keeping listeners alive when
the application no longer needs them.</p>
<p>A listener can be given the Topic object when receiving a message.</p>
</div>
<div class="section" id="publishing">
<h2>Publishing<a class="headerlink" href="#publishing" title="Permalink to this headline">¶</a></h2>
<p>Pubsub publishes a message to all listeners that have subscribed to the
topic of the message. Further, pubsub also publishes the message to
all listeners that have subscribed to more general (i.e. parent) topics
of the message&#8217;s topic.</p>
<p>Pubsub does not define the order of the delivery of a message to its
listeners. However, it does garantee that upon return from the
send operation, all listeners have handled the message and returned
without exception.</p>
</div>
<div class="section" id="kwargs-messaging-protocol">
<h2>Kwargs Messaging Protocol<a class="headerlink" href="#kwargs-messaging-protocol" title="Permalink to this headline">¶</a></h2>
<p>The <em>kwargs</em> protocol is defined as follows:</p>
<ul class="simple">
<li>the transport of all topic message data occurs via keyword arguments
in sendMessage(); the argument names must be the same for all
sendMessage() for a given topic.</li>
<li>the listener&#8217;s parameters must be named the same as the keyword
arguments used in sendMessage()</li>
<li>subtopics can only extend the list of argument names accepted</li>
</ul>
<p>Example: assume a topic &#8216;someTopic&#8217; and subtopic &#8216;someTopic.subTopic&#8217;:</p>
<div class="highlight-python"><pre>from pubsub import pub

def listener(hi): assert msg == 123
pub.subscribe(listener, 'someTopic')

def listener2(hi, foo): assert hi == 123; assert foo = 'bar'
pub.subscribe(listener2, 'someTopic.subTopic')

pub.sendMessage('someTopic.subTopic', hi=123, foo='bar')</pre>
</div>
</div>
<div class="section" id="arg1-messaging-protocol">
<h2>Arg1 Messaging Protocol<a class="headerlink" href="#arg1-messaging-protocol" title="Permalink to this headline">¶</a></h2>
<p>This protocol
is defined as follows:</p>
<ul class="simple">
<li>the transport of all topic message data occurs as one user-defined
Python object, stored in the .data attribute of the object received
by listeners</li>
<li>the listener must accept being called as f(message)</li>
</ul>
<p>Example:</p>
<div class="highlight-python"><pre>from pubsub import setuparg1
from pubsub import pub
def listener(msg): assert msg.data['hi'] == 123
data = dict('hi':123, ...)
pub.sendMessage('someTopic', data)</pre>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="splitsidebar">
        <div class="localsidebarpanel">
            <h3>Page Contents</h3>
            <ul>
<li><a class="reference" href="#">Concepts</a><ul>
<li><a class="reference" href="#messages">Messages</a></li>
<li><a class="reference" href="#topics">Topics</a></li>
<li><a class="reference" href="#listeners">Listeners</a></li>
<li><a class="reference" href="#publishing">Publishing</a></li>
<li><a class="reference" href="#kwargs-messaging-protocol">Kwargs Messaging Protocol</a></li>
<li><a class="reference" href="#arg1-messaging-protocol">Arg1 Messaging Protocol</a></li>
</ul>
</li>
</ul>

            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../_sources/apidocs/concepts.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../modindex.html" title="Global Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="basic_use.html" title="Basic Use"
             >next</a> |</li>
        <li class="right" >
          <a href="examples.html" title="Examples"
             >previous</a> |</li>
        <li>Trail:</li>
          <li> &raquo; <a href="index.html" >API Documentation</a></li>
          <li> &raquo; <a href="#">Concepts</a></li> 
      </ul>
    </div>
    <div class="footer">
      &copy; Copyright 2008, Oliver Schoenborn.
      Last updated on May 05, 2010.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 0.6.5.
    </div>
  </body>
</html>